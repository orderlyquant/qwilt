{
  "hash": "c816f74c7eec48640a6c72754a02bc7a",
  "result": {
    "markdown": "---\ntitle: \"Ha`rvest`ing S&P 500 Sectors\"\ndescription: |\n  Using open source data to look at within industry correlations.\nauthor: Brandon Farr\ndate: 01-28-2021\ncategories: ['tidyquant', 'rvest', 'janitor', 'finance']\n---\n\n::: {.cell}\n\n:::\n\n\nA little work with the `rvest` package. Try to get the current S&P 500\nconstituents from Wikipedia.\n\n\n::: {.cell}\n\n:::\n\n\nAccording to my [SelectorGadget](https://rvest.tidyverse.org/articles/articles/selectorgadget.html)\nwork, the element I am looking for is \"#constituents\"\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n{html_node}\n<table class=\"wikitable sortable\" id=\"constituents\">\n[1] <tbody>\\n<tr>\\n<th>\\n<a href=\"/wiki/Ticker_symbol\" title=\"Ticker symbol\"> ...\n```\n:::\n:::\n\n\nSince this is a table, it needs to be passed through the `html_table`\nfunction.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 503 × 8\n   symbol security           gics_sector gics_sub_industry headquarters_location\n   <chr>  <chr>              <chr>       <chr>             <chr>                \n 1 MMM    3M                 Industrials Industrial Congl… Saint Paul, Minnesota\n 2 AOS    A. O. Smith        Industrials Building Products Milwaukee, Wisconsin \n 3 ABT    Abbott             Health Care Health Care Equi… North Chicago, Illin…\n 4 ABBV   AbbVie             Health Care Pharmaceuticals   North Chicago, Illin…\n 5 ACN    Accenture          Informatio… IT Consulting & … Dublin, Ireland      \n 6 ATVI   Activision Blizza… Communicat… Interactive Home… Santa Monica, Califo…\n 7 ADM    ADM                Consumer S… Agricultural Pro… Chicago, Illinois    \n 8 ADBE   Adobe Inc.         Informatio… Application Soft… San Jose, California \n 9 ADP    ADP                Industrials Human Resource &… Roseland, New Jersey \n10 AAP    Advance Auto Parts Consumer D… Automotive Retail Raleigh, North Carol…\n# ℹ 493 more rows\n# ℹ 3 more variables: date_added <chr>, cik <int>, founded <chr>\n```\n:::\n:::\n\n\nWow! Sure enough, we get a tibble with what we want. Notice the use of\n`janitor` to clean up the column names for convenience. *I think I should\nalways do this.*\n\nLet's look at all of the stocks in the same `gics_sub_industry` as Apple.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  symbol security                   gics_sector            gics_sub_industry    \n  <chr>  <chr>                      <chr>                  <chr>                \n1 AAPL   Apple Inc.                 Information Technology Technology Hardware,…\n2 HPE    Hewlett Packard Enterprise Information Technology Technology Hardware,…\n3 HPQ    HP Inc.                    Information Technology Technology Hardware,…\n4 NTAP   NetApp                     Information Technology Technology Hardware,…\n5 STX    Seagate Technology         Information Technology Technology Hardware,…\n6 WDC    Western Digital            Information Technology Technology Hardware,…\n```\n:::\n:::\n\n\nThis is a great list to pass to `tidyquant` and try pulling some pricing data.\n\n\n::: {.cell}\n\n:::\n\n\nBy default, we get about a years worth of prices. Let's calculate returns:\n\n\n::: {.cell}\n\n:::\n\n\nNow, calculate the correlation matrix:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n# Groups:   symbol_1 [6]\n  symbol_1 symbol_2   cor\n  <chr>    <chr>    <dbl>\n1 AAPL     HPQ      0.607\n2 HPE      HPQ      0.800\n3 HPQ      HPE      0.800\n4 NTAP     HPQ      0.693\n5 STX      WDC      0.791\n6 WDC      STX      0.791\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}